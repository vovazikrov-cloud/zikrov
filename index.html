<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BW Premium Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --accent: #ffffff; }
        body { background-color: #000; color: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .btn-primary { background: var(--accent); color: #000; transition: all 0.2s ease; }
        .btn-primary:active { transform: scale(0.96); opacity: 0.9; }
        .card-product { background: linear-gradient(145deg, #111, #050505); border: 1px solid rgba(255,255,255,0.05); }
        #snow { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 1; }
        .nav-item { opacity: 0.4; transition: 0.3s; cursor: pointer; }
        .nav-item.active { opacity: 1; border-bottom: 2px solid var(--accent); }
        input, select { background: rgba(255,255,255,0.05) !important; border: 1px solid rgba(255,255,255,0.1) !important; color: white !important; }
        .safe-area { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body>
    <canvas id="snow"></canvas>

    <div class="relative z-10 flex flex-col min-h-screen px-5 pt-6 pb-24">
        
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-2xl font-black tracking-tighter uppercase">Premium <span id="accent-text">Store</span></h1>
                <p class="text-[10px] tracking-[0.2em] opacity-40 uppercase">Digital Assets Edition</p>
            </div>
            <div id="user-avatar" class="w-10 h-10 rounded-full bg-white/10 border border-white/20 overflow-hidden"></div>
        </header>

        <main id="main-content">
            <section id="view-shop" class="view space-y-8">
                <div id="shop-container" class="space-y-8">
                    </div>
            </section>

            <section id="view-profile" class="view hidden space-y-6">
                <div class="glass p-6 rounded-3xl text-center">
                    <p class="text-xs opacity-40 uppercase mb-2">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—É–ø–æ–∫</p>
                    <div class="flex justify-around items-center">
                        <div><p class="text-2xl font-bold" id="p-count">0</p><p class="text-[10px] opacity-40">–ó–∞–∫–∞–∑–æ–≤</p></div>
                        <div class="w-px h-8 bg-white/10"></div>
                        <div><p class="text-2xl font-bold" id="p-spent">0 ‚ÇΩ</p><p class="text-[10px] opacity-40">–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</p></div>
                    </div>
                </div>

                <div class="glass p-6 rounded-3xl">
                    <h3 class="text-sm font-bold mb-4 uppercase tracking-widest">–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                    <p class="text-xs opacity-50 mb-3">–í—ã–±–µ—Ä–∏—Ç–µ –∞–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç:</p>
                    <div class="flex gap-4">
                        <button onclick="setAccent('#ffffff')" class="w-8 h-8 rounded-full border border-white/20 bg-white"></button>
                        <button onclick="setAccent('#ff3b30')" class="w-8 h-8 rounded-full border border-white/20 bg-red-600"></button>
                        <button onclick="setAccent('#4cd964')" class="w-8 h-8 rounded-full border border-white/20 bg-green-500"></button>
                        <button onclick="setAccent('#007aff')" class="w-8 h-8 rounded-full border border-white/20 bg-blue-600"></button>
                        <button onclick="setAccent('#ff9500')" class="w-8 h-8 rounded-full border border-white/20 bg-orange-500"></button>
                    </div>
                </div>
            </section>

            <section id="view-admin" class="view hidden space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="font-bold uppercase tracking-widest text-sm">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>
                    <button onclick="exportData()" class="text-[10px] bg-white/10 px-3 py-1 rounded-full text-white/60">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥</button>
                </div>
                
                <div class="glass p-5 rounded-3xl space-y-4">
                    <input id="adm-cat-name" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" class="w-full rounded-xl p-3 text-sm">
                    <button onclick="addCategory()" class="w-full btn-primary p-3 rounded-xl font-bold text-xs uppercase tracking-widest">–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                </div>

                <div id="admin-list" class="space-y-4"></div>

                <div class="glass p-5 rounded-3xl">
                    <p class="text-[10px] opacity-40 mb-2 uppercase">–†–µ–∫–≤–∏–∑–∏—Ç—ã</p>
                    <input id="adm-rekv" type="text" onchange="updateRekv(this.value)" class="w-full rounded-xl p-3 text-sm mb-4">
                </div>
            </section>

            <section id="view-pay" class="view hidden">
                <div class="glass p-8 rounded-[40px] text-center">
                    <div class="mb-6">
                        <h2 id="pay-name" class="text-2xl font-bold mb-1"></h2>
                        <p id="pay-price" class="text-sm opacity-50 font-mono"></p>
                    </div>
                    <div class="bg-white/5 border border-white/10 p-5 rounded-2xl mb-6 break-all font-mono text-xs italic">
                        <p class="opacity-40 mb-2 not-italic uppercase tracking-tighter text-[10px]">–†–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</p>
                        <span id="pay-rekv-val"></span>
                    </div>
                    <input type="file" id="pay-file" class="hidden" onchange="handleFile(this)">
                    <button onclick="document.getElementById('pay-file').click()" id="file-label" class="w-full border border-dashed border-white/20 p-4 rounded-2xl mb-6 text-xs opacity-60">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —á–µ–∫ (Screenshot)</button>
                    <button onclick="completePurchase()" class="w-full btn-primary py-5 rounded-3xl font-black uppercase tracking-widest">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É</button>
                </div>
            </section>
        </main>

        <nav class="fixed bottom-6 left-5 right-5 h-16 glass rounded-full z-50 flex justify-around items-center px-6">
            <div onclick="switchView('shop')" id="nav-shop" class="nav-item active flex flex-col items-center">
                <span class="text-[10px] font-bold uppercase tracking-tighter">Shop</span>
            </div>
            <div onclick="switchView('profile')" id="nav-profile" class="nav-item flex flex-col items-center">
                <span class="text-[10px] font-bold uppercase tracking-tighter">Profile</span>
            </div>
            <div onclick="switchView('admin')" id="nav-admin" class="nav-item flex flex-col items-center">
                <span class="text-[10px] font-bold uppercase tracking-tighter text-red-500">Admin</span>
            </div>
        </nav>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- CONFIG & DATABASE ---
        const MY_TG_USER = 'z1krov';
        
        // –í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON –∏–∑ –∞–¥–º–∏–Ω–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —é–∑–µ—Ä–æ–≤
        const initialDB = {
            categories: [
                { id: 1, name: "Telegram Accounts", items: [{ id: 101, name: "Premium RU 1 Year", price: 1500 }] }
            ],
            rekv: "+79000000000 (Sber/Crypto)"
        };

        let db = JSON.parse(localStorage.getItem('bw_db')) || initialDB;
        let stats = JSON.parse(localStorage.getItem('bw_stats')) || { count: 0, spent: 0 };
        let currentAccent = localStorage.getItem('bw_accent') || '#ffffff';
        let activeItem = null;

        // --- CORE FUNCTIONS ---
        function switchView(view) {
            if (view === 'admin') {
                const p = prompt("Admin Key:");
                if (p !== "2026") return;
            }
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`view-${view}`).classList.remove('hidden');
            document.getElementById(`nav-${view}`).classList.add('active');
            render();
        }

        function setAccent(color) {
            currentAccent = color;
            document.documentElement.style.setProperty('--accent', color);
            localStorage.setItem('bw_accent', color);
            tg.HapticFeedback.impactOccurred('medium');
        }

        function render() {
            // Accent Color
            document.documentElement.style.setProperty('--accent', currentAccent);
            
            // Shop
            const shop = document.getElementById('shop-container');
            shop.innerHTML = db.categories.map(cat => `
                <div class="animate-fade-in">
                    <h3 class="text-[10px] uppercase tracking-[0.3em] opacity-30 mb-4 ml-2">${cat.name}</h3>
                    <div class="grid gap-3">
                        ${cat.items.map(item => `
                            <div onclick="openPay('${cat.name}', '${item.name}', ${item.price})" class="card-product p-5 rounded-[24px] flex justify-between items-center active:scale-95 transition-all">
                                <div><h4 class="font-bold text-sm tracking-tight">${item.name}</h4><p class="text-[10px] opacity-30">Instantly Delivery</p></div>
                                <div class="text-sm font-black">${item.price} ‚ÇΩ</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            // Admin
            const admin = document.getElementById('admin-list');
            admin.innerHTML = db.categories.map(cat => `
                <div class="bg-white/5 p-4 rounded-2xl border border-white/5">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-xs font-bold uppercase text-white/50">${cat.name}</span>
                        <button onclick="addItem(${cat.id})" class="text-[10px] bg-white text-black px-2 py-1 rounded-md font-bold">+ –¢–æ–≤–∞—Ä</button>
                    </div>
                    <div class="space-y-2">
                        ${cat.items.map(i => `
                            <div class="flex justify-between text-xs opacity-60">
                                <span>${i.name}</span>
                                <button onclick="deleteItem(${cat.id}, ${i.id})" class="text-red-500">√ó</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            // Profile
            document.getElementById('p-count').innerText = stats.count;
            document.getElementById('p-spent').innerText = stats.spent + ' ‚ÇΩ';
            document.getElementById('adm-rekv').value = db.rekv;
            
            if (tg.initDataUnsafe?.user?.photo_url) {
                document.getElementById('user-avatar').innerHTML = `<img src="${tg.initDataUnsafe.user.photo_url}" class="w-full h-full object-cover">`;
            }
        }

        // --- SHOP LOGIC ---
        function openPay(cName, iName, price) {
            activeItem = { cName, iName, price };
            document.getElementById('pay-name').innerText = iName;
            document.getElementById('pay-price').innerText = price + ' ‚ÇΩ';
            document.getElementById('pay-rekv-val').innerText = db.rekv;
            switchView('pay');
        }

        function handleFile(input) {
            if (input.files[0]) {
                document.getElementById('file-label').innerText = "‚úÖ –ß–µ–∫ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω: " + input.files[0].name;
                document.getElementById('file-label').classList.add('text-green-500', 'opacity-100');
            }
        }

        function completePurchase() {
            if (!document.getElementById('pay-file').files[0]) return tg.showAlert("–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞!");
            
            stats.count++;
            stats.spent += activeItem.price;
            localStorage.setItem('bw_stats', JSON.stringify(stats));

            const msg = `üßæ –ù–û–í–´–ô –ó–ê–ö–ê–ó%0A%0Aüì¶ –¢–æ–≤–∞—Ä: ${activeItem.iName}%0Aüí∞ –¶–µ–Ω–∞: ${activeItem.price} ‚ÇΩ%0Aüë§ –ö–ª–∏–µ–Ω—Ç: ${tg.initDataUnsafe?.user?.first_name || 'NoName'} (@${tg.initDataUnsafe?.user?.username || 'unknown'})%0A%0A–°–∫—Ä–∏–Ω—à–æ—Ç –ø—Ä–∏–∫—Ä–µ–ø–∏–ª –Ω–∏–∂–µ:`;
            tg.openTelegramLink(`https://t.me/${MY_TG_USER}?text=${encodeURIComponent(msg)}`);
            tg.close();
        }

        // --- ADMIN LOGIC ---
        function addCategory() {
            const n = document.getElementById('adm-cat-name').value;
            if (!n) return;
            db.categories.push({ id: Date.now(), name: n, items: [] });
            saveDB();
            document.getElementById('adm-cat-name').value = '';
        }

        function addItem(cId) {
            const n = prompt("–ù–∞–∑–≤–∞–Ω–∏–µ:");
            const p = prompt("–¶–µ–Ω–∞:");
            if (n && p) {
                db.categories.find(c => c.id === cId).items.push({ id: Date.now(), name: n, price: Number(p) });
                saveDB();
            }
        }

        function deleteItem(cId, iId) {
            const cat = db.categories.find(c => c.id === cId);
            cat.items = cat.items.filter(i => i.id !== iId);
            saveDB();
        }

        function saveDB() {
            localStorage.setItem('bw_db', JSON.stringify(db));
            render();
        }

        function updateRekv(v) { db.rekv = v; saveDB(); }

        function exportData() {
            navigator.clipboard.writeText(JSON.stringify(db));
            tg.showPopup({ message: "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞. –í—Å—Ç–∞–≤—å—Ç–µ –µ—ë –≤ –∫–æ–¥ (initialDB) –∏ –æ–±–Ω–æ–≤–∏—Ç–µ GitHub." });
        }

        // --- SNOW ENGINE ---
        const canvas = document.getElementById('snow');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function initSnow() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            particles = Array.from({ length: 80 }, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                r: Math.random() * 2 + 1,
                d: Math.random() * 1,
                s: Math.random() * 1 + 0.5
            }));
        }

        function drawSnow() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "rgba(255, 255, 255, 0.3)";
            ctx.beginPath();
            particles.forEach(p => {
                ctx.moveTo(p.x, p.y);
                ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
            });
            ctx.fill();
            updateSnow();
        }

        function updateSnow() {
            particles.forEach(p => {
                p.y += p.s;
                p.x += Math.sin(p.y / 50);
                if (p.y > canvas.height) p.y = -10, p.x = Math.random() * canvas.width;
            });
            requestAnimationFrame(drawSnow);
        }

        window.addEventListener('resize', initSnow);
        initSnow();
        drawSnow();
        render();
    </script>
</body>
</html>








